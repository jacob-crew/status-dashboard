<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Status Dashboard</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f4f6f8; padding: 20px; }
    h1 { text-align: center; }
    .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(750px, 1fr)); gap: 1rem; margin-top: 20px; }
    .card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
    .status { font-weight: bold; }
    .green { color: green; }
    .yellow { color: goldenrod; }
    .red { color: crimson; }
  </style>
</head>
<body>
  <h1>Status Dashboard</h1>
  <div class="grid" id="statusGrid"></div>

  <script>
    const companies = [
      { name: "Salesforce", url: "https://api.status.salesforce.com/v1/instances/USA322/status"  },
      { name: "FormAssembly", url: "https://status.formassembly.com/api/v2/status.json" },
      { name: "Blackthorn Events", url: "https://blackthorn.statuspage.io/api/v2/summary.json" },
      { name: "Conga", url: "https://status.conga.com/api/v2/status.json" },
      { name: "Mogli (Twilio)", url: "https://status.twilio.com/api/v2/status.json" },
      { name: "ProvenWorks", url: "https://status.provenworks.com/api/v2/status.json" },
      { name: "Slack", url: "https://slack-status.com/api/v2.0.0/current" },
      { name: "Asana", url: "https://status.asana.com//api/v2/status.json" }
      // Add more here...
    ];

async function loadStatuses() {
  const grid = document.getElementById("statusGrid");
  grid.innerHTML = "";

  for (let company of companies) {
    try {
      let fetchUrl = company.url;

      // Use CORS proxy for non-Statuspage.io APIs
      if (company.type !== "statuspage") {
        fetchUrl = "https://cors-anywhere.herokuapp.com/" + company.url;
      }

      const res = await fetch(fetchUrl);
      const data = await res.json();

      let status, indicator;

      if (company.type === "statuspage") {
        status = data.status?.description || "Unknown";
        indicator = data.status?.indicator || "unknown";
      } else if (company.type === "slack") {
        status = data.status === "ok" ? "Operational" : "Incident";
        indicator = data.status === "ok" ? "none" : "major";
      }

      // Build card
      let colorClasses = {
        none: "bg-green-100 text-green-800",
        minor: "bg-yellow-100 text-yellow-800",
        major: "bg-orange-100 text-orange-800",
        critical: "bg-red-100 text-red-800",
        unknown: "bg-gray-100 text-gray-800"
      };
      let badgeClass = colorClasses[indicator] || colorClasses.unknown;

      grid.innerHTML += `
        <div class="bg-white shadow-md rounded-xl p-6">
          <h2 class="text-lg font-semibold text-gray-900">${company.name}</h2>
          <p class="mt-2">
            <span class="inline-block px-3 py-1 text-sm font-medium rounded-full ${badgeClass}">
              ${status}
            </span>
          </p>
          <div class="mt-4">
            <a href="${company.url}" target="_blank" class="text-blue-500 hover:underline">View Details</a>
          </div>
        </div>
      `;
    } catch (err) {
      console.error(`Failed to fetch ${company.name}`, err);
      grid.innerHTML += `
        <div class="bg-white shadow-md rounded-xl p-6">
          <h2 class="text-lg font-semibold text-gray-900">${company.name}</h2>
          <p class="mt-2 text-red-600">Error loading status</p>
        </div>
      `;
    }
  }
}

loadStatuses();
    setInterval(loadStatuses, 60000); // refresh every 60s
  </script>
</body>
</html>
